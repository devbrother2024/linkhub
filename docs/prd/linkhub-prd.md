# LinkHub Product Requirements Document (PRD)

## 목표 및 배경 컨텍스트

### 목표

- 브랜드 도메인 기반으로 신뢰도 높은 URL 단축 경험을 제공한다.
- Free/Pro 구독 플랜을 도입해 국내 결제를 통한 수익화를 실현한다.
- 소셜 로그인과 배포 자동화를 결합해 확장 가능한 SaaS 운영 흐름을 구축한다.

### 배경 컨텍스트

마케팅·커머스 팀은 여러 캠페인을 빠르게 실행해야 하지만, 외부 단축 링크 서비스는 도메인 일관성과 국내 결제 연동 측면에서 제약이 있다. 또한 국내 사용자는 익숙한 소셜 계정을 활용한 간편 로그인과 원화 결제를 선호한다. 자체 링크 단축 SaaS 서비스인 LinkHub를 구축해 브랜드 도메인, 국내 주요 소셜 로그인 연동, 국내 결제 기반 구독 모델, 클라우드 자동 배포 환경을 통합함으로써 고객 신뢰와 반복 수익을 동시에 확보하고자 한다.

---

## 요구사항

### 기능 요구사항 (Functional Requirements)

#### 링크 생성 및 전달

- **FR001**: 사용자는 URL 입력 후 즉시 단축 링크를 발급받고 복사할 수 있어야 한다.
- **FR002**: 사용자는 커스텀 슬러그와 만료·클릭 제한을 쉽게 설정하거나 수정할 수 있어야 한다.
- **FR003**: 사용자는 생성된 링크의 상태와 사용 가능 조건을 한 화면에서 확인할 수 있어야 한다.

#### 회원 및 수익화 운영

- **FR004**: 신규 사용자는 국내 사용자가 익숙한 소셜 로그인 방식을 통해 간편하게 가입·로그인할 수 있어야 한다.
- **FR005**: Free/Pro 플랜의 혜택과 제한을 비교하고, Pro 구독 시 국내 결제 대행사(PG)를 통해 결제를 완료할 수 있어야 한다.
- **FR006**: 운영자는 서비스 배포 이후 환경 변수와 도메인 설정을 점검하며 안정적인 서비스 상태를 유지할 수 있어야 한다.

### 비기능 요구사항 (Non-Functional Requirements)

- **NFR001**: 사용자는 단축 URL을 통해 원본 페이지로 이동할 때 체감 지연을 느끼지 않아야 한다.
- **NFR002**: 로그인과 결제 흐름은 데스크톱·모바일 환경 모두에서 일관된 경험을 제공해야 한다.
- **NFR003**: 서비스 운영자는 링크 사용 현황과 구독 상태를 쉽게 파악해 고객 문의와 운영 이슈에 대응할 수 있어야 한다.

---

## 사용자 여정 (User Journeys)

### 여정 1: 신규 사용자의 링크 생성 경험

1.  사용자가 서비스 메인 화면에서 소셜 로그인을 진행한다.
2.  로그인 직후 URL 입력 폼에 원본 주소를 입력하고 옵션(커스텀 코드, 만료일, 클릭 제한)을 설정한다.
3.  생성 결과 화면에서 짧은 링크와 활용 가이드를 확인한다.
4.  링크를 복사해 원하는 채널에 공유한다.
5.  링크 목록 화면에서 생성한 링크를 다시 확인하며 필요 시 설정을 수정한다.

### 여정 2: Pro 구독 전환과 서비스 활용

1.  사용자가 Free 플랜 생성 한도에 도달해 업그레이드 안내 메시지를 확인한다.
2.  요금제 비교 화면에서 Pro 혜택과 가격 정보를 검토한다.
3.  국내 결제 대행사(PG) 결제 페이지에서 결제를 완료한다.
4.  결제 성공 메시지를 확인하고, 확장된 링크 생성 한도를 사용한다.
5.  프로필 화면에서 구독 상태와 결제 이력을 확인한다.

---

## UX 디자인 원칙

### 핵심 원칙

- ** 즉시성**: 로그인, 링크 생성, 결제 등 핵심 행동은 최소 단계로 완료되어야 한다.
- ** 명료성**: Free/Pro 혜택과 제한이 명확히 비교되어 의사결정을 돕는다.
- ** 피드백**: 링크 생성, 결제, 플랜 전환 결과를 실시간 피드백으로 확인할 수 있어야 한다.
- ** 접근성**: 다양한 디바이스와 환경에서 동일한 사용성을 제공해야 한다.

### 플랫폼 및 화면

- **플랫폼**: 웹(데스크톱, 태블릿), 모바일 웹
- **핵심 화면**:
  - 로그인 및 온보딩 화면
  - 링크 생성·결과 화면
  - 링크 목록 및 관리 화면
  - 요금제·결제 화면

### 디자인 제약사항

- 브랜드 컬러와 컴포넌트 가이드를 준수해 강의 전반의 일관성을 유지해야 한다.
- 1280px 미만 화면에서도 주요 입력 필드와 액션 버튼이 접히지 않도록 반응형으로 구성해야 한다.
- 결제 화면에는 이용자가 신뢰할 수 있는 결제 대행사 정보를 명확히 노출해야 한다.

---

## UI 디자인 목표

### 주요 UI 요소

1. ** 링크 생성 입력 폼**
   - URL 입력과 옵션 설정을 단계별 안내로 구성한다.
   - 생성 결과와 복사 버튼을 동일 화면에 배치한다.
   - 플랜 제한에 따른 안내 메시지를 함께 노출한다.

2. ** 링크 목록 카드/테이블**
   - 링크 상태, 만료일, 복사 버튼을 직관적으로 배치한다.
   - 즐겨찾기 표시와 검색 필터를 제공한다.
   - 플랜별 생성 가능 수량을 시각적으로 안내한다.

3. ** 요금제 및 결제 패널**
   - Free와 Pro 혜택을 비교형 카드로 제공한다.
   - 결제 호출 버튼과 진행 상태를 명확히 표시한다.
   - 구독 갱신·취소 관련 안내를 포함한다.

### 인터랙션 패턴

- 주요 액션(로그인, 결제, 링크 생성)은 화면 전환 없이 모달 또는 슬라이드 패널에서 처리한다.
- 결제·구독 진행 상태는 단계별 진행 표시를 통해 사용자 불안을 줄인다.
- 위험 작업(삭제, 비활성화)은 2단계 확인과 이유 입력을 요구한다.
- URL 복사, 플랜 전환 등 주요 액션은 토스트 메시지로 결과를 안내한다.

---

## Epic 목록

### Epic 1: 프로젝트 초기화 및 기본 인프라 구축

**상태**: 완료

**목표**: 기술 스택을 확정하고 프론트엔드 프레임워크 프로젝트 초기화, 기본 라이브러리, 데이터베이스 ORM 설정까지 완료한다.

**예상 스토리 수**: 6-7개

### Epic 2: 사용자 인증 및 계정 기반 운영 준비

**상태**: 완료

**목표**: 국내 주요 소셜 로그인과 세션 관리를 구축해 사용자별 접근 제어와 플랜 적용 기반을 마련한다.

**예상 스토리 수**: 6-7개

#### 체크리스트

- [x] 카카오 소셜 로그인 OAuth 클라이언트 등록 및 리다이렉트 설정을 완료한다. (네이버, 구글은 향후 추가 예정)
- [x] OAuth 인증 흐름을 Better Auth 기반으로 구현하고 신규 사용자 온보딩 로직을 정비한다.
- [x] 사용자 계정·플랜 정보를 저장할 데이터베이스 스키마와 마이그레이션을 정의한다.
- [x] 세션 및 토큰 보관 전략(쿠키/스토리지)을 확정하고 만료, 갱신 로직을 구현한다. (Better Auth가 자동 처리)
- [x] 로그인/로그아웃 UI 플로우와 오류 메시지 처리를 완성한다. (플랜 전환 UI는 Epic 3에서 구현 예정)
- [x] 플랜별 접근 제어 미들웨어를 구성한다. (운영 모니터링은 기본 수준 완료, 고급 모니터링은 향후 확장 예정)

### Epic 3: 링크 생성, 수익화, 배포 운영

**목표**: 링크 생성·리다이렉션, 구독 결제, 클라우드 배포 자동화를 연계해 서비스 가치와 수익화를 동시에 구현한다.

**예상 스토리 수**: 9-10개

#### 상세 체크리스트

##### 링크 생성 & 메인 대시보드

- [x] 대시보드 내 URL 입력 폼에서 원본 URL과 옵션(커스텀 슬러그, 만료일, 클릭 제한)을 단일 모달 흐름으로 제출하면 Server Action이 즉시 단축 링크와 복사 버튼을 반환한다.
- [x] 생성된 링크 리스트 테이블에는 상태, 만료일, 누적 클릭 수, 복사/비활성화 액션이 한 행에 정렬되며 검색, 필터 기능을 제공한다. (편집 기능은 향후 추가 예정)
- [x] 대시보드 상단 요약 카드가 일일 링크 생성 한도와 활성 링크 한도를 각각 현재 사용량/총량 형태로 표시한다.
- [x] Free 플랜 사용자는 하루 5개, 활성 링크 30개 제한이 남은 경우 대비 퍼센티지와 경고 메시지를 확인할 수 있다.
- [x] Pro 플랜 사용자는 무제한 생성·활성 한도와 함께 커스텀 슬러그/만료일/클릭 제한 옵션이 항상 노출된다.
- [x] 한도 초과 시 생성 버튼이 비활성화되고, 업그레이드 CTA와 토스트 경고가 동시에 표시된다.
- [x] 만료 임박 또는 클릭 제한 초과가 예상되는 링크는 리스트에서 강조되어 유지보수 필요성을 안내한다.

##### 리다이렉션 & 추적

- [x] `redirect/[slug]` 페이지(Server Component)가 슬러그 인덱스를 활용해 원본 URL을 조회하고 유효 시 즉시 리다이렉션한다.
- [x] 만료되었거나 클릭 한도를 초과한 링크는 커스텀 에러 페이지로 안내하고, 재생성 또는 업그레이드 CTA를 포함한다.
- [x] 리다이렉션 요청마다 clickCount 증가와 `LinkEvent` 로그가 비동기로 기록되며 실패 시 로깅이 작동한다.
- [x] 슬러그 입력은 Zod 검증과 서버 측 고유성 검사를 모두 통과해야만 활성화된다.
- [x] 리다이렉션 응답 시간은 슬러그 인덱스와 캐시 전략을 통해 NFR001 목표(사용자 체감 지연 없음)를 만족한다.

##### 구독 결제 & 플랜 정책

- [x] `lib/plan.ts`에 Free(일 5개/활성 30개), Pro(무제한) 정책이 상수로 정의되어 Server Action과 UI에서 동일하게 사용된다.
- [x] 대시보드와 링크 생성 폼에서 한도 근접 시 업그레이드 배너가 노출되고, `/pricing` 페이지로 이동하는 CTA를 제공한다.
- [ ] Toss Payments 결제 성공 시 웹훅이 시그니처를 검증하고 `Subscription` 및 `User.planType`을 PRO로 갱신한다.
- [ ] 결제 실패·취소 이벤트도 동일 웹훅에서 처리해 상태를 롤백하고 사용자에게 토스트 또는 이메일 알림을 전송한다.
- [ ] 프로필/대시보드에서 구독 상태, 다음 결제일, 결제 이력이 카드 형태로 시각화되어 운영 및 사용자 가시성을 확보한다.

##### 배포 & 운영

- [ ] `scripts/verify-env.ts`가 OAuth, Toss, 브랜드 도메인 등 필수 환경 변수를 검증해 Vercel 배포 파이프라인에서 누락 시 즉시 중단한다.
- [x] 배포 전 Drizzle 마이그레이션을 `pnpm drizzle-kit push`로 적용하고 실패 시 롤백 전략(백업 스냅샷 복원)을 문서화한다.
- [ ] Vercel Edge/Server Functions 로그와 Toss 웹훅 실패 로그를 pino + Log Drain으로 수집해 운영자가 대시보드에서 확인한다.
- [ ] 배포 후 헬스체크 스크립트가 링크 생성, 리다이렉션, 결제 API를 순차 호출해 성공 여부를 슬랙 또는 이메일로 보고한다.
- [ ] 운영자는 대시보드에서 Free/Pro 사용자 비율, 한도 초과 현황, 결제 실패 알림을 확인하고 대응할 수 있다.

---

## 범위 외 (Out of Scope)

### 현재 버전에서 제외되는 기능

- ** 모바일 네이티브 앱**: 웹 우선 전략으로 초기 릴리스에서는 제외한다.
- ** 고급 분석 대시보드**: 향후 확장 주제로 남기고 초기 릴리스에서는 다루지 않는다.
- ** 외부 마케팅 자동화 연동**: 초기 운영 범위를 넘어서므로 제외한다.
- ** AI 기반 추천 슬러그**: 서비스 고도화 이후 단계에서 검토한다.

### 지원하지 않는 플랫폼

- iOS 네이티브 앱
- Android 네이티브 앱
- 데스크톱 전용 클라이언트

### 기술적 제약

- 도입 기술은 현재 조직에서 표준으로 사용하는 프론트엔드/백엔드 프레임워크, 소셜 로그인, 결제 대행사, 배포 플랫폼을 우선 고려한다.
- 향후 교체 가능성을 염두에 두고 외부 서비스 의존도를 최소화하며, 고급 커스터마이징은 롤아웃 이후 단계적으로 적용한다.
